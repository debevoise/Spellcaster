!function(e){var n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(n){return e[n]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/dist/",t(t.s=1)}([function(e,n,t){},function(e,n,t){"use strict";function r(e,n){return[e[0]+n[0],e[1]+n[1]]}function i(e,n){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(n)}t.r(n);var s={all:{type:"all"},clear:{type:"clear"},spell:{type:"spell"},snake:{type:"snake"},type:{type:"typetest"},test:{type:"typetest"},circle:{type:"circle"},fast:{type:"speed",action:.8},slow:{type:"speed",action:1.25},big:{type:"fontsize",action:1.25},little:{type:"fontsize",action:.8},up:{type:"move",action:[-1,0]},down:{type:"move",action:[1,0]},left:{type:"move",action:[0,-1]},right:{type:"move",action:[0,1]},comic:{type:"font",action:"comic"},sans:{type:"font",action:"sans"},fun:{type:"font",action:"fun"},mono:{type:"font",action:"mono"},serif:{type:"font",action:"serif"},blue:{type:"color",action:"#5798ad"},green:{type:"color",action:"#57ad6e"},yellow:{type:"color",action:"#dbc035"},purple:{type:"color",action:"#9d64e3"},orange:{type:"color",action:"#e67e39"},pink:{type:"color",action:"#f20aee"},black:{type:"color",action:"#222e2c"},red:{type:"color",action:"#de481b"},emoji:{type:"emoji"},hello:{type:"text",action:"world"},madeby:{type:"text",action:" simon debevoise"},foo:{type:"text",action:"bar"},explode:{type:"explode"}};function o(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.perFrameKeywords=[],this.appliedKeywords=[],this.grid=n,this.currentPos=this.grid.randomPosition(),this.storedText="",this.activeText="",this.keywordIndex=s,this.rotate=null,this.classArr=[],this.moves=[0,0],this.colors=[],this.font="mono",this.size=15,this.renderedElements=[]}var n,t,l;return n=e,(t=[{key:"receive",value:function(e){this.activeText+=e.toLowerCase(),this.extractKeywords(),this.render()}},{key:"deleteCharacter",value:function(){this.activeText&&(this.activeText=this.activeText.slice(0,this.activeText.length-1))}},{key:"cast",value:function(e){var n=this;e instanceof Array||(e=[e]);var t=["all","clear","spell","snake","test","explode"];e.forEach((function(e){n.applyKeyword(e),t.includes(e)||n.appliedKeywords.push(e)}))}},{key:"applyKeyword",value:function(n){var t=this;if(this.keywordIndex[n]){var i=this.keywordIndex[n],s=i.action;switch(i.type){case"move":this.moves=r(this.moves,s);break;case"color":this.colors.push(s);break;case"rotate":this.rotate=this.rotate?null:"rotate";break;case"font":this.emoji=!1,this.font=s;break;case"snake":this.grid.framerate=150,this.grid.playSnake();break;case"speed":var o=Math.floor(this.grid.framerate*s);this.grid.framerate=o>4e3?4e4:o<100?100:o;break;case"text":this.storedText+=s;break;case"fontsize":var a=Math.floor(this.size*s);this.size=a>40?40:a<6?6:a;break;case"circle":this.classArr.push("circle");break;case"clear":this.grid.spells.forEach((function(e){return e.clearPreviousRender()})),this.grid.spells=[];break;case"emoji":this.emoji=!0;break;case"spell":this.generateRandomSpell();break;case"all":this.grid.spells.forEach((function(e){return e.cast(t.appliedKeywords)}));break;case"typetest":this.grid.playTypetest();break;case"explode":var l;l=0===this.moves[0]&&0===this.moves[1]?[0,1]:this.moves;for(var h=this.currentPos,c=0;c<this.storedText.length;c++){var d=this.storedText[c],u=new e(this.grid);u.cast(this.appliedKeywords),u.currentPos=h,u.exploded=!0;var p=["left","up","right","down"],f=[],m=Math.floor(c%8/2);f.push(p[m]),c%2==1&&f.push(p[(m+1)%4]),u.cast(f),u.storedText=d,this.grid.spells.push(u),h=r(h,l)}this.storedText=""}this.render()}}},{key:"extractKeywords",value:function(){if(this.containsKeyword(this.activeText))for(var e=2;e<=this.activeText.length;e++){var n=this.activeText.slice(0,e),t=this.containsKeyword(n);t&&(this.storedText+=n,this.cast(t),this.activeText=this.activeText.slice(e),this.extractKeywords())}}},{key:"containsKeyword",value:function(e){for(var n=0,t=Object.keys(this.keywordIndex);n<t.length;n++){var r=t[n];if(e.includes(r))return r}return!1}},{key:"clearPreviousRender",value:function(){this.renderedElements.forEach((function(e){return e.remove()}))}},{key:"move",value:function(){this.currentPos=r(this.currentPos,this.moves),this.render()}},{key:"shuffleColors",value:function(){return 0===this.colors.length?"none":1===this.colors.length?this.colors[0]:(this.colors.push(this.colors.shift()),this.colors[0])}},{key:"generateRandomSpell",value:function(){for(var n=Object.keys(this.keywordIndex),t="",r=0;r<4;r++)t+=n[Math.floor(Math.random()*(n.length-6))+6];var i=new e(this.grid);return i.receive(t),this.grid.spells.push(i),i}},{key:"render",value:function(){this.clearPreviousRender();var e,n=this.storedText+this.activeText,t=this.currentPos;e=0===this.moves[0]&&0===this.moves[1]?[0,1]:[Math.sign(this.moves[0]),Math.sign(this.moves[1])];for(var s=0;s<n.length;s++){var a,l=this.emoji?["ðŸ˜ ","ðŸ˜³","ðŸ‘¨â€ðŸ‘¨â€ðŸ‘¦","ðŸ†","ðŸµ","ðŸ±","ðŸ’©","ðŸŒž","ðŸŒˆ","ðŸŒŠ","ðŸ—½","ðŸ›¸","ðŸ‘¨â€ðŸ‘¨â€ðŸ‘¦","ðŸ¥“","ðŸ‘Œ","ðŸž","ðŸŽ¢","ðŸš–","ðŸ©","ðŸ”","ðŸ‡®ðŸ‡·","ðŸ¤¥","ðŸ‘‚","â˜¢","ðŸˆµ","ðŸ¤£"][n[s].toLowerCase().charCodeAt(0)-97]:n[s],h=document.createElement("span");h.textContent=l.toUpperCase(),(a=h.classList).add.apply(a,[this.font,this.rotate,"active"].concat(o(this.classArr))),h.style.fontSize=this.size+"px",h.style.backgroundColor=this.shuffleColors(),this.colors.length>0?h.style.color="white":this.exploded&&(h.style.color="#de481b"),i(this.grid.getElement(t),h),this.renderedElements.push(h),t=r(t,e)}if(this.grid.currentSpell===this){var c=document.createElement("span");c.className="cursor",i(this.grid.getElement(t),c),this.renderedElements.push(c)}}}])&&a(n.prototype,t),l&&a(n,l),e}();function h(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(n,t){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.moves=[0,0],this.positions=[t],this.renderedElements=[],this.grid=n;var r=document.createElement("span");r.className="snakehead",r.innerText="ðŸ",this.body=[r];var i=new l(this.grid);i.storedText="arrow keys to move",i.moves=[0,1],i.cast(["green","blue"]),this.inst=i,this.grid.spells.push(i)}var n,t,s;return n=e,(t=[{key:"isEmpty",value:function(e){return!this.grid.getElement(e).firstChild}},{key:"getPoints",value:function(){return this.positions.length-1}},{key:"handleLoss",value:function(){this.clearPreviousRender();var e=this.inst;e.cast(["orange","fun","big","big","big"]);var n=1==this.body.length-1?" point":" points";e.storedText="Game over: "+(this.body.length-1)+n,this.grid.currentSpell=new l(this.grid)}},{key:"clearPreviousRender",value:function(){this.renderedElements.forEach((function(e){return e.remove()})),this.renderedElements=[]}},{key:"outOfBounds",value:function(e){return e[0]>=this.grid.height||e[0]<0||e[1]>=this.grid.width||e[1]<0}},{key:"move",value:function(){if(this.moves[0]||this.moves[1]){var e,n,t,i=r(this.positions[0],this.moves,this.grid);e=this.positions,n=i,t=!1,e.forEach((function(e){var r,i;i=n,(r=e)[0]===i[0]&&r[1]===i[1]&&(t=!0)})),t||this.outOfBounds(i)?this.handleLoss():(this.isEmpty(i)?(this.positions.unshift(i),this.positions.pop()):(this.positions.unshift(i),this.eat(i)),this.render())}else this.render()}},{key:"receiveInput",value:function(e){var n=r(e,this.moves),t=0===n[0]&&0===n[1];1!==this.positions.length&&t||(this.moves=e)}},{key:"eat",value:function(e){var n=this.grid.getElement(e).firstChild;this.body.push(n)}},{key:"generateRandomSpell",value:function(){new l(this.grid).generateRandomSpell()}},{key:"render",value:function(){var e=this;this.clearPreviousRender(),this.positions.forEach((function(n,t){var r=e.grid.getElement(n),s=e.body[t];s.classList.add("snake"),i(r,s),e.renderedElements.push(s)}))}}])&&h(n.prototype,t),s&&h(n,s),e}(),d="the\nof\nto\nand\na\nin\nis\nit\nyou\nthat\nhe\nwas\nfor\non\nare\nwith\nas\nI\nhis\nthey\nbe\nat\none\nhave\nthis\nfrom\nor\nhad\nby\nnot\nword\nbut\nwhat\nsome\nwe\ncan\nout\nother\nwere\nall\nthere\nwhen\nup\nuse\nyour\nhow\nsaid\nan\neach\nshe\nwhich\ndo\ntheir\ntime\nif\nwill\nway\nabout\nmany\nthen\nthem\nwrite\nwould\nlike\nso\nthese\nher\nlong\nmake\nthing\nsee\nhim\ntwo\nhas\nlook\nmore\nday\ncould\ngo\ncome\ndid\nnumber\nsound\nno\nmost\npeople\nmy\nover\nknow\nwater\nthan\ncall\nfirst\nwho\nmay\ndown\nside\nbeen\nnow\nfind\nany\nnew\nwork\npart\ntake\nget\nplace\nmade\nlive\nwhere\nafter\nback\nlittle\nonly\nround\nman\nyear\ncame\nshow\nevery\ngood\nme\ngive\nour\nunder\nname\nvery\nthrough\njust\nform\nsentence\ngreat\nthink\nsay\nhelp\nlow\nline\ndiffer\nturn\ncause\nmuch\nmean\nbefore\nmove\nright\nboy\nold\ntoo\nsame\ntell\ndoes\nset\nthree\nwant\nair\nwell\nalso\nplay\nsmall\nend\nput\nhome\nread\nhand\nport\nlarge\nspell\nadd\neven\nland\nhere\nmust\nbig\nhigh\nsuch\nfollow\nact\nwhy\nask\nmen\nchange\nwent\nlight\nkind\noff\nneed\nhouse\npicture\ntry\nus\nagain\nanimal\npoint\nmother\nworld\nnear\nbuild\nself\nearth\nfather\nhead\nstand\nown\npage\nshould\ncountry\nfound\nanswer\nschool\ngrow\nstudy\nstill\nlearn\nplant\ncover\nfood\nsun\nfour\nbetween\nstate\nkeep\neye\nnever\nlast\nlet\nthought\ncity\ntree\ncross\nfarm\nhard\nstart\nmight\nstory\nsaw\nfar\nsea\ndraw\nleft\nlate\nrun\ndon't\nwhile\npress\nclose\nnight\nreal\nlife\nfew\nnorth\nopen\nseem\ntogether\nnext\nwhite\nchildren\nbegin\ngot\nwalk\nexample\nease\npaper\ngroup\nalways\nmusic\nthose\nboth\nmark\noften\nletter\nuntil\nmile\nriver\ncar\nfeet\ncare\nsecond\nbook\ncarry\ntook\nscience\neat\nroom\nfriend\nbegan\nidea\nfish\nmountain\nstop\nonce\nbase\nhear\nhorse\ncut\nsure\nwatch\ncolor\nface\nwood\nmain\nenough\nplain\ngirl\nusual\nyoung\nready\nabove\never\nred\nlist\nthough\nfeel\ntalk\nbird\nsoon\nbody\ndog\nfamily\ndirect\npose\nleave\nsong\nmeasure\ndoor\nproduct\nblack\nshort\nnumeral\nclass\nwind\nquestion\nhappen\ncomplete\nship\narea\nhalf\nrock\norder\nfire\nsouth\nproblem\npiece\ntold\nknew\npass\nsince\ntop\nwhole\nking\nspace\nheard\nbest\nhour\nbetter\ntrue\nduring\nhundred\nfive\nremember\nstep\nearly\nhold\nwest\nground\ninterest\nreach\nfast\nverb\nsing\nlisten\nsix\ntable\ntravel\nless\nmorning\nten\nsimple\nseveral\nvowel\ntoward\nwar\nlay\nagainst\npattern\nslow\ncenter\nlove\nperson\nmoney\nserve\nappear\nroad\nmap\nrain\nrule\ngovern\npull\ncold\nnotice\nvoice\nunit\npower\ntown\nfine\ncertain\nfly\nfall\nlead\ncry\ndark\nmachine\nnote\nwait\nplan\nfigure\nstar\nbox\nnoun\nfield\nrest\ncorrect\nable\npound\ndone\nbeauty\ndrive\nstood\ncontain\nfront\nteach\nweek\nfinal\ngave\ngreen\noh\nquick\ndevelop\nocean\nwarm\nfree\nminute\nstrong\nspecial\nmind\nbehind\nclear\ntail\nproduce\nfact\nstreet\ninch\nmultiply\nnothing\ncourse\nstay\nwheel\nfull\nforce\nblue\nobject\ndecide\nsurface\ndeep\nmoon\nisland\nfoot\nsystem\nbusy\ntest\nrecord\nboat\ncommon\ngold\npossible\nplane\nstead\ndry\nwonder\nlaugh\nthousand\nago\nran\ncheck\ngame\nshape\nequate\nhot\nmiss\nbrought\nheat\nsnow\ntire\nbring\nyes\ndistant\nfill\neast\npaint\nlanguage\namong\ngrand\nball\nyet\nwave\ndrop\nheart\nam\npresent\nheavy\ndance\nengine\nposition\narm\nwide\nsail\nmaterial\nsize\nvary\nsettle\nspeak\nweight\ngeneral\nice\nmatter\ncircle\npair\ninclude\ndivide\nsyllable\nfelt\nperhaps\npick\nsudden\ncount\nsquare\nreason\nlength\nrepresent\nart\nsubject\nregion\nenergy\nhunt\nprobable\nbed\nbrother\negg\nride\ncell\nbelieve\nfraction\nforest\nsit\nrace\nwindow\nstore\nsummer\ntrain\nsleep\nprove\nlone\nleg\nexercise\nwall\ncatch\nmount\nwish\nsky\nboard\njoy\nwinter\nsat\nwritten\nwild\ninstrument\nkept\nglass\ngrass\ncow\njob\nedge\nsign\nvisit\npast\nsoft\nfun\nbright\ngas\nweather\nmonth\nmillion\nbear\nfinish\nhappy\nhope\nflower\nclothe\nstrange\ngone\njump\nbaby\neight\nvillage\nmeet\nroot\nbuy\nraise\nsolve\nmetal\nwhether\npush\nseven\nparagraph\nthird\nshall\nheld\nhair\ndescribe\ncook\nfloor\neither\nresult\nburn\nhill\nsafe\ncat\ncentury\nconsider\ntype\nlaw\nbit\ncoast\ncopy\nphrase\nsilent\ntall\nsand\nsoil\nroll\ntemperature\nfinger\nindustry\nvalue\nfight\nlie\nbeat\nexcite\nnatural\nview\nsense\near\nelse\nquite\nbroke\ncase\nmiddle\nkill\nson\nlake\nmoment\nscale\nloud\nspring\nobserve\nchild\nstraight\nconsonant\nnation\ndictionary\nmilk\nspeed\nmethod\norgan\npay\nage\nsection\ndress\ncloud\nsurprise\nquiet\nstone\ntiny\nclimb\ncool\ndesign\npoor\nlot\nexperiment\nbottom\nkey\niron\nsingle\nstick\nflat\ntwenty\nskin\nsmile\ncrease\nhole\ntrade\nmelody\ntrip\noffice\nreceive\nrow\nmouth\nexact\nsymbol\ndie\nleast\ntrouble\nshout\nexcept\nwrote\nseed\ntone\njoin\nsuggest\nclean\nbreak\nlady\nyard\nrise\nbad\nblow\noil\nblood\ntouch\ngrew\ncent\nmix\nteam\nwire\ncost\nlost\nbrown\nwear\ngarden\nequal\nsent\nchoose\nfell\nfit\nflow\nfair\nbank\ncollect\nsave\ncontrol\ndecimal\ngentle\nwoman\ncaptain\npractice\nseparate\ndifficult\ndoctor\nplease\nprotect\nnoon\nwhose\nlocate\nring\ncharacter\ninsect\ncaught\nperiod\nindicate\nradio\nspoke\natom\nhuman\nhistory\neffect\nelectric\nexpect\ncrop\nmodern\nelement\nhit\nstudent\ncorner\nparty\nsupply\nbone\nrail\nimagine\nprovide\nagree\nthus\ncapital\nwon't\nchair\ndanger\nfruit\nrich\nthick\nsoldier\nprocess\noperate\nguess\nnecessary\nsharp\nwing\ncreate\nneighbor\nwash\nbat\nrather\ncrowd\ncorn\ncompare\npoem\nstring\nbell\ndepend\nmeat\nrub\ntube\nfamous\ndollar\nstream\nfear\nsight\nthin\ntriangle\nplanet\nhurry\nchief\ncolony\nclock\nmine\ntie\nenter\nmajor\nfresh\nsearch\nsend\nyellow\ngun\nallow\nprint\ndead\nspot\ndesert\nsuit\ncurrent\nlift\nrose\ncontinue\nblock\nchart\nhat\nsell\nsuccess\ncompany\nsubtract\nevent\nparticular\ndeal\nswim\nterm\nopposite\nwife\nshoe\nshoulder\nspread\narrange\ncamp\ninvent\ncotton\nborn\ndetermine\nquart\nnine\ntruck\nnoise\nlevel\nchance\ngather\nshop\nstretch\nthrow\nshine\nproperty\ncolumn\nmolecule\nselect\nwrong\ngray\nrepeat\nrequire\nbroad\nprepare\nsalt\nnose\nplural\nanger\nclaim\ncontinent\noxygen\nsugar\ndeath\npretty\nskill\nwomen\nseason\nsolution\nmagnet\nsilver\nthank\nbranch\nmatch\nsuffix\nespecially\nfig\nafraid\nhuge\nsister\nsteel\ndiscuss\nforward\nsimilar\nguide\nexperience\nscore\napple\nbought\nled\npitch\ncoat\nmass\ncard\nband\nrope\nslip\nwin\ndream\nevening\ncondition\nfeed\ntool\ntotal\nbasic\nsmell\nvalley\nnor\ndouble\nseat\narrive\nmaster\ntrack\nparent\nshore\ndivision\nsheet\nsubstance\nfavor\nconnect\npost\nspend\nchord\nfat\nglad\noriginal\nshare\nstation\ndad\nbread\ncharge\nproper\nbar\noffer\nsegment\nslave\nduck\ninstant\nmarket\ndegree\npopulate\nchick\ndear\nenemy\nreply\ndrink\noccur\nsupport\nspeech\nnature\nrange\nsteam\nmotion\npath\nliquid\nlog\nmeant\nquotient\nteeth\nshell\nneck".split(/[\r\n]+/).filter((function(e){return e.length>2})),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.length;return d.slice(0,e)};function p(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.grid=n,this.width=Math.floor(.7*this.grid.width),this.pos=this.calculatePos(),this.userWords=[],this.currentWord=0,this.badkeystrokes=0,this.renderedWordBegin=0,this.renderedWordEnd=0,this.renderedElements=[],this.numRows=3,this.currentTime,this.input="",this.topWords=u(),this.ensureUserWords()}var n,t,s;return n=e,(t=[{key:"over",value:function(){this.clearPreviousRender();var e=new Spell(this.grid);e.cast(["big","red","yellow","mono","right","down","big"]),e.storedText=this.calculateWPM()+" WPM",this.grid.spells.push(e),this.grid.exitTypetest()}},{key:"calculateWPM",value:function(){if(!this.currentTime)return 0;for(var e=0,n=0;n<this.currentWord;n++){var t=this.userWords[n];t.mistyped||(e+=t.word.length+1)}return Math.floor(e/5)}},{key:"clearPreviousRender",value:function(){this.renderedElements.forEach((function(e){return e.remove()}))}},{key:"timesUp",value:function(){if(!this.currentTime)return!1;var e=new Date;return 60-Math.floor((e.getTime()-this.currentTime.getTime())/1e3)<0}},{key:"render",value:function(){this.clearPreviousRender(),this.timesUp()?this.over():(this.renderPadding(),this.renderWordDisplay(),this.renderInput())}},{key:"renderPadding",value:function(){for(var e=this.numRows+7,n=this.pos[0]-2,t=this.pos[1]-2,r=this.width+4,s=0;s<e;s++)for(var o=0;o<r;o++){var a=document.createElement("span"),l=this.grid.getElement([s+n,o+t]);a.className="test-padding",this.renderedElements.push(a),i(l,a)}}},{key:"renderInput",value:function(){for(var e=this.numRows+this.pos[0]+2,n=this.pos[1],t=this.width-6,r=this.width,s=this.calculateTime(),o=0;o<t;o++){var a=document.createElement("span"),l=this.grid.getElement([e,o+n]);a.classList.add("test-input","typetest"),this.renderedElements.push(a),this.input[o]&&(a.innerText=this.input[o]),o===this.input.length&&a.classList.add("current"),i(l,a),r=o+n+3}for(var h=0;h<s.length;h++){var c=document.createElement("span"),d=this.grid.getElement([e,h+r]);c.classList.add("test-time","typetest"),this.renderedElements.push(c),c.innerText=s[h],i(d,c)}}},{key:"renderWordDisplay",value:function(){for(var e=0,n=0,t=0;t<this.numRows;t+=2){for(var r=0;r<=this.width;){var i=this.renderedWordBegin+e,s=this.userWords[i];if(r+s.word.length>this.width)break;var o=[t,r];this.renderWord(i,o),e+=1,r+=s.word.length+1}0===t&&(n=e)}this.renderedWordEnd=this.renderedWordBegin+n,this.currentWord>=this.renderedWordEnd&&(this.renderedWordBegin=this.currentWord)}},{key:"calculateTime",value:function(){if(!this.currentTime)return"1:00";var e=new Date,n=60-Math.floor((e.getTime()-this.currentTime.getTime())/1e3);if(n<0)return"0:00";var t=n%60;return Math.floor(n/60)+":"+(t=t<10?"0"+t:t.toString())}},{key:"renderWord",value:function(e,n){var t=r(this.pos,[0,0]),s=r(t,n),o=this.userWords[e],a="none";o.mistyped?a="red":e<this.currentWord?a="success":e===this.currentWord&&(a=this.userWords[this.currentWord].word===this.input?"success":"current");for(var l=0;l<o.word.length;l++){var h=r(s,[0,l]),c=this.grid.getElement(h),d=document.createElement("span");d.innerHTML=o.word[l],d.classList.add("typetest",a),this.renderedElements.push(d),i(c,d)}}},{key:"nextWord",value:function(){if(0!==this.input.length){this.ensureUserWords();var e=this.userWords[this.currentWord];e.mistyped=this.input!==e.word,this.input="",this.currentWord++}}},{key:"validateCurrentWord",value:function(){var e=this.userWords[this.currentWord],n=new RegExp("^"+this.input);e.mistyped=!n.test(e.word)}},{key:"ensureUserWords",value:function(){if(this.userWords.length<50+this.currentWord)for(var e=0;e<=50;e++){var n=Math.floor(Math.random()*this.topWords.length),t={word:this.topWords[n],mistyped:!1};this.userWords.push(t)}}},{key:"calculatePos",value:function(){return[5,Math.ceil(.3*this.grid.width/2)]}},{key:"receive",value:function(e){if([13,32].includes(e.keyCode))this.nextWord();else if(e.keyCode>=65&&e.keyCode<91||222===e.keyCode)this.currentTime||(this.currentTime=new Date),this.input+=e.key,this.validateCurrentWord();else{if(27===e.keyCode)return void this.grid.exitTypetest();8===e.keyCode&&(this.input&&(this.input=this.input.slice(0,this.input.length-1)),this.validateCurrentWord())}this.render()}}])&&p(n.prototype,t),s&&p(n,s),e}();function m(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(n,t){var r=this;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.root=n,this.input=t,this.CELLSIZE=25,this.cursorPos=[0,0],this.height=Math.ceil(n.offsetHeight/this.CELLSIZE)-2,this.width=Math.floor(n.offsetWidth/this.CELLSIZE),this.spells=[],this.currentSpell=new l(this),this.framerate=200,this.typetest=null,this.grid=this.populate(),this.play=!0;var i=document.getElementById("keywords-list"),o=document.getElementById("logo");document.getElementById("cast-new-spell").onclick=function(){return r.nextSpell()},o.onclick=function(){r.grid.push(r.currentSpell.generateRandomSpell())},Object.keys(s).forEach((function(e){var n=document.createElement("li");n.innerText=e,n.onclick=function(){return r.currentSpell.receive(e)},i.appendChild(n)})),this.resizeGrid=this.resizeGrid.bind(this),this.receiveInput=this.receiveInput.bind(this),this.receiveClick=this.receiveClick.bind(this),document.addEventListener("keydown",this.receiveInput),this.root.addEventListener("click",(function(e){var n=e.target.dataset.pos;n&&r.receiveClick(n)})),window.onresize=this.resizeGrid}var n,t,i;return n=e,(t=[{key:"populate",value:function(){for(var e=[],n=0;n<this.height;n++){var t=[],r=document.createElement("ul");r.className="row";for(var i=0;i<this.width;i++){var s=document.createElement("div");s.className="cell",s.dataset.pos=[n,i],t.push(s),r.appendChild(s)}this.root.appendChild(r),e.push(t)}return e}},{key:"clearGridElements",value:function(){for(;this.root.firstChild;)this.root.firstChild.remove()}},{key:"resizeGrid",value:function(){var e=document.getElementById("root");this.clearGridElements(),this.height=Math.floor(e.offsetHeight/this.CELLSIZE)-1,this.width=Math.floor(e.offsetWidth/this.CELLSIZE),this.grid=this.populate()}},{key:"nextSpell",value:function(){if(this.snakeMode())this.currentSpell.clearPreviousRender(),this.currentSpell=new l(grid);else if(this.currentSpell.storedText||this.currentSpell.activeText)this.spells.push(this.currentSpell),this.currentSpell=new l(grid);else{var e=this.currentSpell;this.currentSpell=new l(grid),e.render()}}},{key:"getElement",value:function(e){var n=e[0]%this.height,t=e[1]%this.width;return n<0&&(n+=this.height),t<0&&(t+=this.width),this.grid[n][t]}},{key:"snakeMode",value:function(){return this.currentSpell instanceof c}},{key:"playSnake",value:function(){var e=this.currentSpell;this.spells.push(e);var n=[Math.floor(this.height/2),Math.floor(this.width/2)];this.currentSpell=new c(this,n)}},{key:"playTypetest",value:function(){this.spells.push(this.currentSpell);var e=new l(this);e.cast(["right","green"]),e.storedText="press esc to exit",e.currentPos=[1,1],this.currentSpell=e,this.typetest&&this.typetest.clearPreviousRender(),this.typetest=new f(this),this.typetest.render()}},{key:"exitTypetest",value:function(){this.typetest&&this.typetest.clearPreviousRender(),this.typetest=null,this.currentSpell.clearPreviousRender(),this.currentSpell=new l(this)}},{key:"receiveClick",value:function(e){if(!this.snakeMode()){var n=e.split(",").map((function(e){return parseInt(e)}));this.currentSpell&&(this.currentSpell.currentPos=n)}}},{key:"updateCurrentPosition",value:function(e){var n;switch(e){case 37:n=[0,-1];break;case 38:n=[-1,0];break;case 39:n=[0,1];break;case 40:n=[1,0]}if(this.snakeMode())this.currentSpell.receiveInput(n);else{var t=this.currentSpell.currentPos;this.currentSpell.currentPos=r(n,t),this.currentSpell.render()}}},{key:"randomPosition",value:function(){return[Math.floor(Math.random()*this.height),Math.floor(Math.random()*this.width)]}},{key:"receiveInput",value:function(e){if(27===e.keyCode&&(this.currentSpell&&this.currentSpell.clearPreviousRender(),this.currentSpell=new l(this)),this.typetest)this.typetest.receive(e);else if(13===e.keyCode||32===e.keyCode)this.nextSpell();else if(e.keyCode>=65&&e.keyCode<91){if(this.snakeMode())return;this.currentSpell.receive(e.key)}else if(8===e.keyCode&&this.currentSpell){if(this.snakeMode())return;this.currentSpell.deleteCharacter()}else e.keyCode<=40&&e.keyCode>=37&&this.updateCurrentPosition(e.keyCode)}},{key:"trimSpells",value:function(){if(!(this.spells.length<100)){for(var e=this.spells.length-100,n=0;n<e;n++)this.spells[n].clearPreviousRender();this.spells=this.spells.slice(e)}}},{key:"frame",value:function(){this.trimSpells(),this.spells.forEach((function(e){return e.move()})),this.currentSpell.move(),this.typetest&&this.typetest.render()}},{key:"animate",value:function(e){var n=this;this.framerate=e||this.framerate,this.timeout=setTimeout((function(){n.frame(),n.animate()}),this.framerate)}}])&&m(n.prototype,t),i&&m(n,i),e}();t(0);document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("root"),n=document.getElementById("input");window.Spell=l;var t=new y(e,n);t.animate(),window.grid=t,window.sampleText=u,window.typetest=new f(t)}))}]);
//# sourceMappingURL=main.js.map